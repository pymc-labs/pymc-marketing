---
name: Check for broken links

on:
  workflow_dispatch: # allow manual trigger
  push:
    branches:
      - main
  schedule:
    # run daily at 4 am
    # * is a special character in YAML so you have to quote this string
    - cron:  "0 4 * * *"

jobs:
  index:
    runs-on: ubuntu-latest
    steps:
    - name: Checking links
      uses: ScholliYT/Broken-Links-Crawler-Action@v3
      with:
        website_url: "https://www.pymc-marketing.io/en/latest/index.html,https://www.pymc-marketing.io/en/latest/getting_started/index.html,https://www.pymc-marketing.io/en/latest/contributing/index.html,https://www.pymc-marketing.io/en/latest/guide/index.html"
        # Twitter has a redirect which fails the check, I did a manual check for it and it was working
        exclude_url_prefix: "mailto:,https://www.linkedin.com,https://linkedin.com,https://twitter.com"
        verbose: "error"
        connect_limit_per_host: 50
        resolve_before_filtering: "true"
        max_retry_time: 30
        max_retries: 5
        max_depth: 2
  docs:
    runs-on: ubuntu-latest
    steps:
    - name: Checking links
      uses: ScholliYT/Broken-Links-Crawler-Action@v3
      with:
        website_url: "https://www.pymc-marketing.io/en/latest/notebooks/index.html"
        # Twitter has a redirect which fails the check, I did a manual check for it and it was working
        exclude_url_prefix: "mailto:,https://www.linkedin.com,https://linkedin.com,https://twitter.com"
        verbose: "error"
        connect_limit_per_host: 50
        resolve_before_filtering: "true"
        max_retry_time: 30
        max_retries: 5
        max_depth: -1
